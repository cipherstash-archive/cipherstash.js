name: Test PR â€” pnpm packages
on:
  pull_request:
    branches: [ main ]
  push:
    branches: [ main ]

defaults:
  run:
    shell: bash -l {0}

jobs:
  build-pnpm:
    name: build + test (pnpm packages)
    runs-on: ubuntu-latest

    steps:
    - uses: actions/checkout@v2

    - uses: ./.github/actions/cache-asdf

    - name: "Setup"
      run: |
        ./build.sh setup
    - name: "Build"
      run: |
        ./build.sh build
    - name: "Test"
      run: |
        ./build.sh test

    - run: asdf current
